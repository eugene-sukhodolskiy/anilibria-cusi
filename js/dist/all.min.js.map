{"version":3,"sources":["Alert.js","App.js","Auth.js","CacheProvider.js","Loader.js","PostRender.js","Renderer.js","Router.js","StoredPlayerDataManager.js","conf.js","functions.js","initers.js"],"names":["Alert","constructor","type","content","isSingleton","isClosable","this","id","Date","getTime","Math","random","alertsList","referenceComponent","document","querySelector","console","error","template","cloneNode","getInstance","initComponent","classList","add","setAttribute","innerHTML","addEventListener","e","preventDefault","close","showIn","container","append","setTimeout","remove","changeContent","newContent","closeAlertComponent","alertId","createAlertComponent","createGlobalAlertComponent","alert","querySelectorAll","forEach","item","currentTarget","getAttribute","App","router","Router","auth","Auth","renderer","Renderer","postRender","PostRender","loader","Loader","cacheProvider","CacheProvider","storedPlayerDataManager","StoredPlayerDataManager","init","initers","urlMonitor","initDisplayingAuthBtns","initPreloadSpinner","initBaseEvents","initGenres","initGoToTopBtn","renderPreloadSpinner","logout","contains","hideMobNav","showMobNav","squery","keyCode","value","trim","location","hash","blur","lmap","home","homePageUpToLoad","search","searchPageUpToLoad","genres","genresPageUpToLoad","let","p","page","renderContainer","from","childNodes","length","resp","list","insertListToRenderContainer","genresList","items","appendChild","renderGenresList","node","getSessionId","goTopBtn","goTopBtnVisibilityHandler","window","pageYOffset","step","round","animationInterval","setInterval","newPageYOffset","max","scrollTo","top","clearInterval","app","formSelector","form","submitBtn","initForm","email","passwd","xhr","XMLHttpRequest","open","onload","status","JSON","parse","response","err","localStorage","setItem","sessionId","mes","fdata","FormData","send","removeItem","unsetCache","cache","lifetime","createAt","manager","storage","getItem","setCache","key","data","saveCache","stringify","cacheable","code","callback","currentTimestamp","anilibriaRequest","after","limit","_CONF","perPage","filter","getItemCardFields","decodeURI","split","selectedGenres","getSelectedGenres","join","favouritesList","sessId","cacheableCallback","session","sorting_type","itemCard","html","nodeFromHTML","parentNode","single","post","i","playerData","default_quality","preroll_deny","file","player","files","host","hls","sd","hd","fhd","push","skip","skips","opening","title","poster","download","Playerjs","renderFavoriteBtn","favoriteBtn","postId","addToFavourites","removeFromFavourites","genreBtn","genre","inx","map","indexOf","splice","renderThumbnail","string","watched","localPlayerData","currentEpisode","episodes","last","posters","medium","url","renderItemCard","thumb","names","ru","season","year","full_string","renderTorrents","torrents","torrent","size","total_size","toString","substr","torrent_id","quality","seeders","leechers","renderSingle","en","description","renderGenreBtn","createElement","btn","pagesContainerSelector","defaultPageId","notFoundPageId","containerSelector","findedPages","pages","currentPage","currentPath","zindex","goToPage","pageId","style","zIndex","route","initPage","pageName","localStorageItemName","restorePlayerDataFromBackup","cleanupBackupedPlayerData","backupPlayerData","getStorablePlayerData","bPlayerData","getBackupedPlayerData","timing","len","backupedPlayerData","path","pathname","timestamp","episode","Object","keys","ID","watchedAt","Number","MAX_VALUE","api","domen","ver","numbOfRelevant","stdXHR","method","onloadCallback","setRequestHeader","onerror","makeSelectedGenresActivated","api2Flag","setPageTitle","pageTitle","title_id","name","params","query","URLSearchParams","val","parseInt","include","ids","resp2","series","favs","j"],"mappings":"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","file":"all.min.js","sourcesContent":["class Alert {\n\tconstructor(type, content, isSingleton, isClosable) {\n\t\tthis.id = \"alert-id-\" + (new Date()).getTime() + Math.random();\n\t\talertsList[this.id] = this;\n\t\tthis.type = type;\n\t\tthis.content = content || \"\";\n\t\tthis.isSingleton = isSingleton || false;\n\t\tthis.isClosable = isClosable || false;\n\n\t\tconst referenceComponent = document.querySelector(`.component.alert[data-id=\"alert-id-reference\"]`);\n\t\tif(!referenceComponent){\n\t\t\treturn console.error(\"Reference of alert component not found\");\n\t\t}\n\n\t\tthis.template = referenceComponent.cloneNode(true);\n\t\tthis.template.getInstance = () => this;\n\t\tthis.initComponent();\n\t}\n\n\tinitComponent() {\n\t\tthis.template.classList.add(`alert-${this.type}`);\n\t\tthis.template.setAttribute(\"data-id\", this.id);\n\t\tthis.template.querySelector(\".content\").innerHTML = this.content;\n\n\t\tthis.template.querySelector(\".close-alert\").addEventListener(\"click\", e => {\n\t\t\te.preventDefault();\n\t\t\tthis.close();\n\t\t});\n\t}\n\n\tshowIn(container) {\n\t\tif(!this.template){\n\t\t\treturn false;\n\t\t}\n\n\t\tif(this.isSingleton){\n\t\t\tcontainer.innerHTML = \"\";\n\t\t}\n\t\tcontainer.append(this.template);\n\t\tsetTimeout(() => {\n\t\t\tthis.template.classList.add(\"show\");\n\t\t}, 10);\n\n\t\treturn this;\n\t}\n\n\tclose() {\n\t\tthis.template.classList.remove(\"show\");\n\t\tsetTimeout(() => {\n\t\t\tthis.template.remove();\n\t\t\tdelete alertsList[this.id];\n\t\t}, 150);\n\t}\n\n\tchangeContent(newContent) {\n\t\tthis.template.querySelector(\".content\").innerHTML = newContent;\n\t}\n}\n\nconst closeAlertComponent = alertId => {\n\treturn alertsList[alertId]?.close();\n}\n\nconst createAlertComponent = (type, content, isSingleton, isClosable) => {\n\treturn new Alert(type, content, isSingleton, isClosable);\n}\n\nconst createGlobalAlertComponent = (type, content, isSingleton, isClosable) => {\n\tconst alert = createAlertComponent(type, content, isSingleton, isClosable);\n\talert.showIn(document.querySelector(\".global-alerts-container\"));\n\treturn alert;\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", e => {\n\tdocument.querySelectorAll(`.component.alert .close-alert`).forEach(item => {\n\t\titem.addEventListener(\"click\", e => {\n\t\t\te.preventDefault();\n\t\t\tconst alertId = e.currentTarget.getAttribute(\"data-close-alert-id\");\n\t\t\tcloseAlertComponent(alertId);\n\t\t});\n\t});\n});\n\nconst alertsList = {};","class App {\n\tconstructor() {\n\t\tthis.router = new Router(\".page-container\", \"home\", \"not-found\");\n\t\tthis.auth = new Auth(\"#login .login-form form\");\n\t\tthis.renderer = new Renderer();\n\t\tthis.postRender = new PostRender();\n\t\tthis.loader = new Loader();\n\t\tthis.cacheProvider = new CacheProvider();\n\t\tthis.storedPlayerDataManager = new StoredPlayerDataManager();\n\n\t\tsetTimeout(() => {\n\t\t\tthis.init();\n\t\t}, 10);\n\t}\n\n\tinit() {\n\t\tiniters(this);\n\t\tthis.router.urlMonitor();\n\n\t\tthis.initDisplayingAuthBtns();\n\t\tthis.initPreloadSpinner();\n\t\tthis.initBaseEvents();\n\t\tthis.initGenres();\n\t\tthis.initGoToTopBtn();\n\t}\n\n\tinitPreloadSpinner() {\n\t\tdocument.querySelectorAll(\".preload-spinner\").forEach(item => {\n\t\t\titem.innerHTML = this.renderer.renderPreloadSpinner();\n\t\t});\n\t}\n\n\tinitBaseEvents() {\n\t\tdocument.querySelector(\".logout-btn\").addEventListener(\"click\", e => {\n\t\t\tthis.auth.logout();\n\t\t});\n\n\t\tdocument.querySelector(\".btn-nav-on-mob-show\").addEventListener(\"click\", e => {\n\t\t\tif(e.currentTarget.classList.contains(\"active\")) {\n\t\t\t\thideMobNav();\n\t\t\t}else{\n\t\t\t\tshowMobNav();\n\t\t\t}\n\t\t});\n\n\t\tdocument.querySelector(`[name=\"search\"]`).addEventListener(\"keyup\", e => {\n\t\t\te.preventDefault();\n\t\t\tif(e.keyCode == 13) {\n\t\t\t\tlet squery = e.currentTarget.value.trim();\n\t\t\t\tdocument.location.hash = `page:search;sq:${squery}`;\n\t\t\t\te.currentTarget.blur();\n\t\t\t}\n\t\t});\n\n\t\tconst lmap = { \n\t\t\thome: this.loader.homePageUpToLoad, \n\t\t\tsearch: this.loader.searchPageUpToLoad, \n\t\t\tgenres: this.loader.genresPageUpToLoad \n\t\t};\n\t\tfor(let p in lmap) {\n\t\t\tconst page = document.querySelector(`#${p}`);\n\t\t\tpage.querySelector(`.more-btn`).addEventListener(\"click\", e => {\n\t\t\t\tconst renderContainer = page.querySelector(\".render-container\");\n\t\t\t\tconst from = renderContainer.childNodes.length;\n\t\t\t\tpage.querySelector(`.more-btn-wrap .preload-spinner`).classList.remove(\"dnone\");\n\t\t\t\tpage.querySelector(`.more-btn`).classList.add(\"dnone\");\n\n\t\t\t\tlmap[p](from, resp => {\n\t\t\t\t\tpage.querySelector(`.more-btn-wrap .preload-spinner`).classList.add(\"dnone\");\n\t\t\t\t\tif(resp.list.length) {\n\t\t\t\t\t\tpage.querySelector(`.more-btn`).classList.remove(\"dnone\");\n\t\t\t\t\t}\n\t\t\t\t\tinsertListToRenderContainer(renderContainer, resp.list);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\tinitGenres() {\n\t\tthis.loader.genresList(items => {\n\t\t\tdocument.querySelector(\"#genres .render-genres\").appendChild(this.renderer.renderGenresList(items).node);\n\t\t});\n\t}\n\n\tinitDisplayingAuthBtns() {\n\t\tif(getSessionId()) {\n\t\t\tdocument.querySelector(\".logout-btn\").classList.remove(\"dnone\");\n\t\t\tdocument.querySelector(\".go-login-page-btn\").classList.add(\"dnone\");\n\t\t} else {\n\t\t\tdocument.querySelector(\".logout-btn\").classList.add(\"dnone\");\n\t\t\tdocument.querySelector(\".go-login-page-btn\").classList.remove(\"dnone\");\n\t\t}\n\t}\n\n\tinitGoToTopBtn() {\n\t\tconst goTopBtn = document.querySelector(\".go-to-top\");\n\n\t\tconst goTopBtnVisibilityHandler = () => {\n\t\t\tif(window.pageYOffset > 500) {\n\t\t\t\tif(!goTopBtn.classList.contains(\"show\")) {\n\t\t\t\t\tgoTopBtn.classList.add(\"show\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif(goTopBtn.classList.contains(\"show\")) {\n\t\t\t\t\tgoTopBtn.classList.remove(\"show\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tgoTopBtnVisibilityHandler();\n\n\t\twindow.addEventListener(\"scroll\", e => {\n\t\t\tgoTopBtnVisibilityHandler();\n\t\t});\n\n\t\tgoTopBtn.addEventListener(\"click\", e => {\n\t\t\tconst duration = 50;\n\t\t\tconst step = Math.round(window.pageYOffset / duration);\n\n\t\t\tconst animationInterval = setInterval(() => {\n\t\t\t\tconst newPageYOffset = Math.max(0, window.pageYOffset - step);\n\n\t\t\t\twindow.scrollTo({\n\t\t\t\t\ttop: newPageYOffset \n\t\t\t\t});\n\n\t\t\t\tif(!newPageYOffset) {\n\t\t\t\t\treturn clearInterval(animationInterval);\n\t\t\t\t}\n\t\t\t}, 1);\n\t\t});\n\t}\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", e => {\n\tconst app = new App();\n\twindow.app = () => app;\n});","class Auth {\n\tconstructor(formSelector) {\n\t\tthis.formSelector = formSelector;\n\t\tthis.form = document.querySelector(this.formSelector);\n\t\tthis.submitBtn = this.form.querySelector(\".submit-btn\");\n\t\tthis.initForm();\n\t}\n\n\tinitForm() {\n\t\tthis.form.addEventListener(\"submit\", e => {\n\t\t\te.preventDefault();\n\t\t\tif(this.submitBtn.classList.contains(\"disable\")) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.submitBtn.classList.add(\"disable\");\n\n\t\t\tconst email = this.form.querySelector(\"#email\").value;\n\t\t\tconst passwd = this.form.querySelector(\"#passwd\").value;\n\n\t\t\tconst xhr = new XMLHttpRequest();\n\t\t\txhr.open(\"POST\", \"https://www.anilibria.tv/public/login.php\");\n\t\t\txhr.onload = () => {\n\t\t\t\tthis.submitBtn.classList.remove(\"disable\");\n\n\t\t\t\tif(xhr.status == 200) {\n\t\t\t\t\tconst resp = JSON.parse(xhr.response);\n\t\t\t\t\tif(resp.err == \"ok\") {\n\t\t\t\t\t\tlocalStorage.setItem(\"sessionId\", resp.sessionId);\n\t\t\t\t\t\tconst alert = createGlobalAlertComponent(\"success\", \"Успешно!\");\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\talert.close();\n\t\t\t\t\t\t}, 2000);\n\t\t\t\t\t\tdocument.location.hash = \"#\";\n\t\t\t\t\t\tdocument.querySelector(\".logout-btn\").classList.remove(\"dnone\");\n\t\t\t\t\t\tdocument.querySelector(\".go-login-page-btn\").classList.add(\"dnone\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst alert = createGlobalAlertComponent(\"danger\", resp.mes);\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\talert.close();\n\t\t\t\t\t\t}, 4500);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst alert = createGlobalAlertComponent(\"danger\", \"Сервер не доступен\");\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\talert.close();\n\t\t\t\t\t}, 4500);\n\t\t\t\t}\t\t\t\t\n\t\t\t}\n\n\t\t\tconst fdata = new FormData();\n\t\t\tfdata.append(\"mail\", email);\n\t\t\tfdata.append(\"passwd\", passwd);\n\t\t\tfdata.append(\"fa2code\", \"\");\n\t\t\tfdata.append(\"csrf\", \"1\");\n\t\t\txhr.send(fdata);\n\t\t});\n\t}\n\n\tlogout() {\n\t\tlocalStorage.removeItem(\"sessionId\");\n\t\tdocument.location.hash = \"#page:login\";\n\t\tdocument.querySelector(\".logout-btn\").classList.add(\"dnone\");\n\t\tdocument.querySelector(\".go-login-page-btn\").classList.remove(\"dnone\");\n\t\tapp().cacheProvider.unsetCache(\"favouritesList\");\n\t}\n}","class CacheProvider {\n\tconstructor() {\n\t\tthis.cache = {};\n\t\tthis.lifetime = {};\n\t\tthis.createAt = {};\n\n\t\tthis.init();\n\t\tsetInterval(() => {\n\t\t\tthis.manager();\n\t\t}, 1000);\n\t}\n\n\tinit() {\n\t\tlet storage = localStorage.getItem(\"cache\");\n\t\tif(storage) {\n\t\t\tstorage = JSON.parse(storage);\n\t\t\tthis.cache = storage.cache;\n\t\t\tthis.lifetime = storage.lifetime;\n\t\t\tthis.createAt = storage.createAt;\n\t\t}\n\t}\n\n\tsetCache(key, data, lifetime) {\n\t\tthis.cache[key] = data;\n\t\tthis.lifetime[key] = lifetime;\n\t\tthis.createAt[key] = Math.round((new Date()).getTime() / 1000);\n\n\t\tthis.saveCache();\n\t}\n\n\tsaveCache() {\n\t\tlocalStorage.setItem(\"cache\", JSON.stringify({\n\t\t\tcache: this.cache,\n\t\t\tlifetime: this.lifetime,\n\t\t\tcreateAt: this.createAt\n\t\t}));\n\t}\n\n\tcacheable(key, code, callback, lifetime) {\n\t\tif(this.cache[key]) {\n\t\t\treturn callback(this.cache[key]);\n\t\t}\n\n\t\tcode(data => {\n\t\t\tthis.setCache(key, data, lifetime);\n\t\t\tcallback(data);\n\t\t});\n\t}\n\n\tunsetCache(key) {\n\t\tif(this.cache[key]) {\n\t\t\tdelete this.cache[key] \n\t\t\tdelete this.lifetime[key] \n\t\t\tdelete this.createAt[key]\n\t\t\tthis.saveCache();\n\t\t}\n\t}\n\n\tmanager() {\n\t\tconst currentTimestamp = Math.round((new Date()).getTime() / 1000);\n\n\t\tfor(let key in this.cache) {\n\t\t\tif(!this.lifetime[key]) \n\t\t\t\tcontinue;\n\n\t\t\tif(currentTimestamp - this.createAt[key] > this.lifetime[key]) {\n\t\t\t\tthis.unsetCache(key);\n\t\t\t}\n\t\t}\n\t}\n}","class Loader {\n\tconstructor() {}\n\n\thomePageUpToLoad(from, callback) {\n\t\tanilibriaRequest(\n\t\t\t\"title/updates\", \n\t\t\t{\n\t\t\t\tafter: from,\n\t\t\t\tlimit: _CONF.perPage.home,\n\t\t\t\tfilter: getItemCardFields()\n\t\t\t}, \n\t\t\tresp => callback(resp)\n\t\t);\n\t}\n\n\tsearchPageUpToLoad(from, callback) {\n\t\tlet squery = decodeURI(document.location.hash.split(\"sq:\")[1]);\n\n\t\tanilibriaRequest(\n\t\t\t\"title/search\", \n\t\t\t{\n\t\t\t\tafter: from,\n\t\t\t\tlimit: _CONF.perPage.search,\n\t\t\t\tfilter: getItemCardFields(),\n\t\t\t\tsearch: squery\n\t\t\t}, \n\t\t\tresp => callback(resp)\n\t\t);\n\t}\n\n\tgenresPageUpToLoad(from, callback) {\n\t\tconst selectedGenres = getSelectedGenres();\n\n\t\tanilibriaRequest(\n\t\t\t\"title/search\", \n\t\t\t{\n\t\t\t\tsearch: \"\",\n\t\t\t\tfilter: getItemCardFields(),\n\t\t\t\tgenres: selectedGenres.join(\",\"),\n\t\t\t\tafter: from,\n\t\t\t\tlimit: _CONF.perPage.search,\n\t\t\t}, \n\t\t\tresp => callback(resp)\n\t\t);\n\t}\n\n\tfavouritesList(callback) {\n\t\tconst sessId = getSessionId();\n\t\tif(!sessId) {\n\t\t\treturn setTimeout(() => document.location.hash = \"#page:login\", 20);\n\t\t}\n\n\t\tapp().cacheProvider.cacheable(\n\t\t\t\"favouritesList\", \n\t\t\tcacheableCallback => {\n\t\t\t\tanilibriaRequest(\n\t\t\t\t\t\"v2.13:getFavorites\", \n\t\t\t\t\t{\n\t\t\t\t\t\tsession: sessId,\n\t\t\t\t\t\tlimit: 100,\n\t\t\t\t\t\tfilter: getItemCardFields(true),\n\t\t\t\t\t}, \n\t\t\t\t\tresp => cacheableCallback(resp)\n\t\t\t\t);\n\t\t\t}, \n\t\t\tcallback,\n\t\t\t60 * 5\n\t\t);\n\t}\n\n\tgenresList(callback) {\n\t\tapp().cacheProvider.cacheable(\n\t\t\t\"genresList\",\n\t\t\tcacheableCallback => {\n\t\t\t\tanilibriaRequest(\n\t\t\t\t\t\"genres\", \n\t\t\t\t\t{\n\t\t\t\t\t\tsorting_type: 1\n\t\t\t\t\t}, \n\t\t\t\t\tresp => cacheableCallback(resp)\n\t\t\t\t);\n\t\t\t},\n\t\t\tcallback,\n\t\t\t60 * 60 * 3\n\t\t);\n\t}\n}","class PostRender {\n\tconstructor() {}\n\n\titemCard(html) {\n\t\tconst item = nodeFromHTML(html);\n\n\t\titem.querySelector(\".thumbnail-img\").addEventListener(\"load\", e => {\n\t\t\te.currentTarget.parentNode.parentNode.classList.add(\"load-ready\");\n\t\t});\n\n\t\treturn item;\n\t}\n\n\tsingle(html, post) {\n\t\tconst item = nodeFromHTML(html);\n\n\t\tconst playerData = {\n\t\t\tid: \"main-player-\" + post.id,\n\t\t\tdefault_quality: \"720p\",\n\t\t\tpreroll_deny: \"\",\n\t\t\tfile: []\n\t\t};\n\n\n\t\tfor(let i in post.player.list) {\n\t\t\tlet files = `[480p]https://${post.player.host}${post.player.list[i].hls.sd}`;\n\n\t\t\tif(post.player.list[i].hls.hd) {\n\t\t\t\tfiles += `,[720p]https://${post.player.host}${post.player.list[i].hls.hd}`;\n\t\t\t}\n\n\t\t\tif(post.player.list[i].hls.fhd) {\n\t\t\t\tfiles += `,[1080p]https://${post.player.host}${post.player.list[i].hls.fhd}`;\n\t\t\t}\n\n\t\t\tplayerData.file.push({\n\t\t\t\tid: \"s\" + i,\n\t\t\t\tskip: post.player.list[i].skips.opening.length ? post.player.list[i].skips.opening.join(\"-\") : null,\n\t\t\t\ttitle: `Серия ${i}`,\n\t\t\t\tposter: null,\n\t\t\t\tdownload: null,\n\t\t\t\tfile: files\n\t\t\t});\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tlet player = new Playerjs(playerData);\n\t\t}, 30);\n\n\t\titem.querySelector(\".fav-btn-wrap\").appendChild(app().renderer.renderFavoriteBtn(post).node);\n\n\t\titem.querySelector(\".thumbnail-img\").addEventListener(\"load\", e => {\n\t\t\te.currentTarget.parentNode.classList.add(\"load-ready\");\n\t\t});\n\n\t\treturn item;\n\t}\n\n\tfavoriteBtn(html, postId) {\n\t\tconst item = nodeFromHTML(html);\n\n\t\tconst sessId = getSessionId();\n\t\tif(sessId) {\n\t\t\titem.querySelector(\".state.unset-from\").classList.add(\"dnone\");\n\t\t\titem.querySelector(\".state.set-to\").classList.remove(\"dnone\");\n\n\t\t\tapp().loader.favouritesList(resp => {\n\t\t\t\tfor(let i=0; i<resp.length; i++) {\n\t\t\t\t\tif(postId == resp[i].id) {\n\t\t\t\t\t\titem.querySelector(\".state.unset-from\").classList.remove(\"dnone\");\n\t\t\t\t\t\titem.querySelector(\".state.set-to\").classList.add(\"dnone\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\titem.classList.remove(\"dnone\");\n\t\t\t});\n\t\t\t\n\t\t\titem.addEventListener(\"click\", e => {\n\t\t\t\tif(e.currentTarget.querySelector(\".unset-from\").classList.contains(\"dnone\")) {\n\t\t\t\t\taddToFavourites(postId, resp => {\n\t\t\t\t\t\titem.querySelector(\".state.unset-from\").classList.remove(\"dnone\");\n\t\t\t\t\t\titem.querySelector(\".state.set-to\").classList.add(\"dnone\");\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tremoveFromFavourites(postId, resp => {\n\t\t\t\t\t\titem.querySelector(\".state.unset-from\").classList.add(\"dnone\");\n\t\t\t\t\t\titem.querySelector(\".state.set-to\").classList.remove(\"dnone\");\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn item;\n\t}\n\n\tgenreBtn(html) {\n\t\tconst item = nodeFromHTML(html);\n\n\t\titem.addEventListener(\"click\", e => {\n\t\t\te.preventDefault();\n\t\t\tconst genre = e.currentTarget.getAttribute(\"data-genre-name\");\n\t\t\tlet selectedGenres = document.location.hash.split(\"sg:\")[1];\n\t\t\tselectedGenres = selectedGenres \n\t\t\t\t? selectedGenres.split(\",\").map(item => { return decodeURI(item); }) \n\t\t\t\t: [];\n\n\t\t\tconst inx = selectedGenres.indexOf(genre);\n\t\t\tif(inx === -1) {\n\t\t\t\tselectedGenres.push(genre);\n\t\t\t\te.currentTarget.classList.add(\"active\");\n\t\t\t} else {\n\t\t\t\tselectedGenres.splice(inx, 1);\n\t\t\t\te.currentTarget.classList.remove(\"active\");\n\t\t\t}\n\n\t\t\tdocument.location.hash = \"page:genres;sg:\" + selectedGenres.join(\",\");\n\t\t});\n\n\t\treturn item;\n\t}\n}","class Renderer {\n\tconstructor() {}\n\n\trenderThumbnail(post) {\n\t\tconst status = post.status.string ? post.status.string : \"Завершен\";\n\t\tconst watched = (post.localPlayerData && post.localPlayerData.currentEpisode == post.player.episodes.last)\n\t\t\t? `<div class=\"thumb-label watched\">Просмотрено</div>`\n\t\t\t: \"\"\n\n\t\treturn `\n\t\t\t<div class=\"component thumbnail\">\n\t\t\t\t<img src=\"//anilibria.tv${post.posters.medium.url}\" class=\"thumbnail-img\">\n\t\t\t\t<img \n\t\t\t\t\tsrc=\"data:image/jpeg;base64,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\" \n\t\t\t\t\tclass=\"poster-placeholder\"\n\t\t\t\t>\n\t\t\t\t<div class=\"hover-effect\">\n\t\t\t\t\t<span class=\"mdi mdi-arrow-right\"></span>\n\t\t\t\t</div>\n\t\t\t\t${watched}\n\t\t\t\t<div class=\"thumb-label status\">${status}</div>\n\t\t\t\t<div class=\"thumb-label series\">Серий ${post.player.episodes.last}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderItemCard(post) {\n\t\tlet genres = post.genres.join(\", \");\n\t\tconst thumb = this.renderThumbnail(post);\n\n\t\tlet html = `<a href=\"#page:single;id${post.id}\" class=\"no-decoration item-link\">\n\t\t\t<div class=\"component card item-card\" data-id=\"${post.id}\">\n\t\t\t\t${thumb}\n\t\t\t\t<div class=\"info\">\n\t\t\t\t\t<div class=\"title\">${post.names.ru} (<span class=\"year\">${post.season.year}</span>)</div>\n\t\t\t\t\t<div class=\"meta\">\n\t\t\t\t\t\t<div class=\"genres\">${genres}</div>\n\t\t\t\t\t\t<div class=\"type\">${post.type.full_string}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</a>`;\n\n\t\treturn {\n\t\t\tstring: html,\n\t\t\tnode: app().postRender.itemCard(html)\n\t\t};\n\t}\n\n\trenderTorrents(post) {\n\t\tlet html = `<div class=\"component torrents\">`;\n\n\t\tfor(let i=0; i<post.torrents.list.length; i++) {\n\t\t\tconst torrent = post.torrents.list[i];\n\t\t\tlet size = torrent.total_size / 1024 / 1024;\n\t\t\tsize = (size > 1024) \n\t\t\t\t? (size / 1024).toString().split(\".\")[0] + \".\" + (size / 1024).toString().split(\".\")[1].substr(0,2) + \" ГБ\" \n\t\t\t\t: size.toString().split(\".\")[0] + \".\" +  size.toString().split(\".\")[1].substr(0,2) + \" МБ\";\n\t\t\thtml += `\n\t\t\t\t<div class=\"torrent\" data-torrent-id=\"${torrent.torrent_id}\">\n\t\t\t\t\t<div class=\"series\">Серии ${torrent.episodes.string}</div>\n\t\t\t\t\t<div class=\"quality\">${torrent.quality.string}</div>\n\t\t\t\t\t\n\t\t\t\t\t<div class=\"seed-leech\">\n\t\t\t\t\t\t<span class=\"seed\">\n\t\t\t\t\t\t\t<span class=\"mdi mdi-arrow-up\"></span>\n\t\t\t\t\t\t\t${torrent.seeders}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"leech\">\n\t\t\t\t\t\t\t<span class=\"mdi mdi-arrow-down\"></span>\n\t\t\t\t\t\t\t${torrent.leechers}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"download\">\n\t\t\t\t\t\t<a href=\"//anilibria.tv${torrent.url}\" class=\"std-btn btn-success\" target=\"_blank\">\n\t\t\t\t\t\t\t<span class=\"mdi mdi-download\"></span>\n\t\t\t\t\t\t\t<span class=\"btn-label\">Скачать</span>\n\t\t\t\t\t\t\t<span class=\"btn-tsize\">${size}</span>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t}\n\n\trenderFavoriteBtn(post) {\n\t\tconst html = `<button class=\"std-btn btn-warning fav-btn dnone\" data-id=\"${post.id}\">\n\t\t\t<span class=\"state unset-from\">\n\t\t\t\t<span class=\"mdi mdi-star\"></span>\n\t\t\t\tВ избранном\n\t\t\t</span>\n\t\t\t<span class=\"state set-to\">\n\t\t\t\t<span class=\"mdi mdi-star-outline\"></span>\n\t\t\t\tДобавить в избранное\n\t\t\t</span>\n\t\t</button>`;\n\n\t\treturn {\n\t\t\thtml: html,\n\t\t\tnode: app().postRender.favoriteBtn(html, post.id)\n\t\t};\n\t}\n\n\trenderSingle(post) {\n\t\tlet genres = this.renderGenresList(post.genres).html;\n\t\tconst thumb = this.renderThumbnail(post);\n\t\tconst torrents = this.renderTorrents(post);\n\n\t\tlet html = `<div class=\"component single-item\">\n\t\t\t<div class=\"std-row\">\n\t\t\t\t${thumb}\n\t\t\t\t<div class=\"item-info\">\n\t\t\t\t\t<h2 class=\"title\"><strong>${post.names.ru}</strong> / ${post.names.en}</h2>\n\t\t\t\t\t<div class=\"time-period\">${post.season.string || \"\"} ${post.season.year}</div>\n\t\t\t\t\t<div class=\"genres\">${genres}</div>\n\t\t\t\t\t<div class=\"type\">${post.type.full_string}</div>\n\t\t\t\t\t<div class=\"description\">${post.description}</div>\n\t\t\t\t\t<div class=\"control-panel\">\n\t\t\t\t\t\t<div class=\"fav-btn-wrap\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${torrents}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"player\" id=\"main-player-${post.id}\"></div>\n\t\t</div>`;\n\n\t\treturn {\n\t\t\tstring: html,\n\t\t\tnode: app().postRender.single(html, post)\n\t\t};\n\t}\n\n\trenderPreloadSpinner() {\n\t\treturn `<div class=\"loadingio-spinner-dual-ball-9pyhqeozhs\"><div class=\"ldio-jyt13pqa73\">\n\t\t\t<div></div><div></div><div></div>\n\t\t\t</div></div>`;\n\t}\n\n\trenderGenreBtn(genre) {\n\t\tlet html = `<a \n\t\t\thref=\"#page:genres;sg:${genre}\" \n\t\t\tclass=\"std-btn genre-btn\" \n\t\t\tdata-genre-name=\"${genre}\"\n\t\t>\n\t\t\t${genre}\n\t\t</a>`;\n\n\t\treturn {\n\t\t\thtml: html,\n\t\t\tnode: app().postRender.genreBtn(html)\n\t\t};\n\t}\n\n\trenderGenresList(genres) {\n\t\tlet container = document.createElement(\"DIV\");\n\t\tcontainer.classList.add(\"genres-wrap\");\n\t\tlet html = `<div class=\"genres-wrap\">`;\n\t\tfor(let i=0; i<genres.length; i++) {\n\t\t\tconst btn = this.renderGenreBtn(genres[i]);\n\t\t\tcontainer.appendChild(btn.node);\n\t\t\thtml += btn.html;\n\t\t}\n\n\t\thtml += \"</div>\";\n\n\t\treturn {\n\t\t\thtml: html,\n\t\t\tnode: container\n\t\t};\n\t}\n}","class Router {\n\tconstructor(pagesContainerSelector, defaultPageId, notFoundPageId) {\n\t\tthis.containerSelector = pagesContainerSelector;\n\t\tthis.container = document.querySelector(this.containerSelector);\n\t\tthis.defaultPageId = defaultPageId;\n\t\tthis.notFoundPageId = notFoundPageId;\n\t\tthis.initers = {};\n\t\tconst findedPages = this.container.querySelectorAll(\".page[id]\");\n\n\t\tthis.pages = {};\n\t\tfor(let i=0; i<findedPages.length; i++) {\n\t\t\tthis.pages[findedPages[i].getAttribute(\"id\")] = findedPages[i];\n\t\t}\n\n\t\tthis.currentPage = \"default-val\";\n\t\tthis.currentPath = \"default-val\";\n\t\tthis.zindex = 1;\n\t}\n\n\tgoToPage(pageId) {\n\t\tif(typeof pageId == \"undefined\") {\n\t\t\treturn document.location.hash = `page:${this.defaultPageId}`;\n\t\t}\n\n\t\tif(typeof this.pages[pageId] == \"undefined\") {\n\t\t\treturn this.goToPage(this.notFoundPageId);\n\t\t}\n\n\t\tthis.container.querySelectorAll(\".page.show\").forEach( p => {\n\t\t\treturn p.classList.remove(\"show\");\n\t\t} );\n\n\t\tif(typeof this.pages[pageId] != \"undefined\") {\n\t\t\tthis.initers[\"_page\"] && this.initers[\"_page\"](this, pageId);\n\t\t\tthis.initers[pageId] && this.initers[pageId](this);\n\t\t\tthis.pages[pageId].style.zIndex = this.zindex;\n\t\t\tthis.zindex++;\n\t\t}\n\n\t\tthis.pages[pageId]?.classList.add(\"show\");\n\t\twindow.scrollTo({ top: 0 });\n\t\tthis.currentPage = pageId;\n\t\tthis.currentPath = document.location.hash;\n\t}\n\n\turlMonitor() {\n\t\tsetInterval(() => {\n\t\t\tconst route = document.location.hash.split(\"page:\")[1];\n\t\t\tif(document.location.hash != this.currentPath) {\n\t\t\t\tthis.goToPage(route?.split(\";\")[0]);\n\t\t\t}\n\t\t}, 10);\n\t}\n\n\tinitPage(pageName, callback) {\n\t\tthis.initers[pageName] = callback;\n\t}\n}","class StoredPlayerDataManager {\n\tconstructor() {\n\t\tthis.localStorageItemName = \"player_data_backup\";\n\t\t\n\t\tthis.restorePlayerDataFromBackup();\n\t\tthis.cleanupBackupedPlayerData();\n\n\t\tsetInterval(() => {\n\t\t\tthis.backupPlayerData();\n\t\t}, 3000);\n\t\t\n\t\tsetInterval(() => {\n\t\t\tthis.cleanupBackupedPlayerData();\n\t\t}, 5 * 60 * 1000);\n\t}\n\n\tbackupPlayerData() {\n\t\tconst playerData = getStorablePlayerData();\n\t\tconst bPlayerData = this.getBackupedPlayerData();\n\t\tfor(let id in playerData) {\n\t\t\tif(bPlayerData[id]) {\n\t\t\t\tbPlayerData[id].currentEpisode = playerData[id].currentEpisode;\n\t\t\t\tbPlayerData[id].timing.watched = playerData[id].timing.watched;\n\t\t\t\tbPlayerData[id].timing.len = playerData[id].timing.len;\n\t\t\t} else {\n\t\t\t\tbPlayerData[id] = playerData[id];\n\t\t\t}\n\t\t}\n\n\t\tlocalStorage.setItem(this.localStorageItemName, JSON.stringify(bPlayerData));\n\t}\n\n\tgetBackupedPlayerData() {\n\t\tconst backupedPlayerData = localStorage.getItem(this.localStorageItemName);\n\t\tif(!backupedPlayerData) {\n\t\t\treturn {};\n\t\t}\n\n\t\treturn JSON.parse(backupedPlayerData);\n\t}\n\n\trestorePlayerDataFromBackup() {\n\t\tconst playerData = this.getBackupedPlayerData();\n\t\tconst path = document.location.host + document.location.pathname;\n\t\tconst timestamp = (new Date()).getTime();\n\n\t\tfor(let id in playerData) {\n\t\t\tconst episode = playerData[id].currentEpisode;\n\t\t\tconst watched = playerData[id].timing.watched;\n\t\t\tconst len = playerData[id].timing.len || 0;\n\t\t\tconst data = `{x-${(episode-1)}-s${episode}}${watched}.0--${len}.0--${timestamp}`;\n\t\t\tlocalStorage.setItem(`pljsplayfrom_main-player-${id}${path}`, data);\n\t\t}\n\t}\n\n\tcleanupBackupedPlayerData() {\n\t\tconst playerData = this.getBackupedPlayerData();\n\t\tlet length = Object.keys(playerData).length;\n\t\tif(length <= 300) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet ID = -1;\n\t\tlet watchedAt = Number.MAX_VALUE;\n\t\tfor(let id in playerData) {\n\t\t\tif(playerData[id].timing.watchedAt < watchedAt) {\n\t\t\t\tID = id;\n\t\t\t\twatchedAt = playerData[id].timing.watchedAt;\n\t\t\t}\n\t\t}\n\n\t\tplayerData[ID] && delete playerData[ID];\n\t\tlocalStorage.setItem(this.localStorageItemName, JSON.stringify(playerData));\n\t}\n}","const _CONF = {\n\tapi: {\n\t\tdomen: \"api.anilibria.tv\",\n\t\tver: \"v3\"\n\t},\n\n\tperPage: {\n\t\thome: 20,\n\t\tsearch: 20,\n\t\tgenres: 20\n\t},\n\t\n\tnumbOfRelevant: 12\n};","const getSessionId = () => {\n\tconst sessId = localStorage.getItem(\"sessionId\");\n\tif(sessId) {\n\t\treturn sessId;\n\t}\n\n\treturn false;\n};\n\nconst stdXHR = (method, url, onloadCallback) => {\n\tconst xhr = new XMLHttpRequest();\n\txhr.open(method, url);\n\txhr.setRequestHeader(\"Cache-Control\", \"no-cache, no-store, max-age=0\");\n\n\txhr.onload = () => {\n\t\tif(xhr.status == 200) {\n\t\t\tonloadCallback(xhr);\n\t\t} else {\n\t\t\tif(xhr.status == 404) {\n\t\t\t\tapp().router.goToPage(\"not-found\");\n\t\t\t}\n\t\t\tconst alert = createGlobalAlertComponent(\"danger\", \"Ошибка загрузки данных\");\n\t\t\tsetTimeout(() => alert.close(), 3000);\n\t\t}\n\t}\n\n\txhr.onerror = () => {\n\t\tconst alert = createGlobalAlertComponent(\"danger\", \"Сервер не доступен\");\n\t\tsetTimeout(() => alert.close(), 3000);\n\t}\n\n\treturn xhr;\n}\n\nconst showMobNav = () => {\n\tdocument.querySelector(\".btn-nav-on-mob-show\").classList.add(\"active\");\n\tdocument.querySelectorAll(\".navigation-main-wrapper, .userbar-wrapper\").forEach(item => {\n\t\titem.classList.add(\"show\");\n\t});\n}\n\nconst hideMobNav = () => {\n\tdocument.querySelector(\".btn-nav-on-mob-show\").classList.remove(\"active\");\n\tdocument.querySelectorAll(\".navigation-main-wrapper, .userbar-wrapper\").forEach(item => {\n\t\titem.classList.remove(\"show\");\n\t});\n}\n\nconst makeSelectedGenresActivated = () => {\n\tlet selectedGenres = document.location.hash.split(\"sg:\")[1];\n\tselectedGenres = selectedGenres \n\t\t? selectedGenres.split(\",\").map(item => { return decodeURI(item); }) \n\t\t: [];\n\tdocument.querySelectorAll(\"#genres .render-genres .genre-btn.active\").forEach(\n\t\ti => i.classList.remove(\"active\")\n\t);\n\tfor(let i=0; i<selectedGenres.length; i++) {\n\t\tdocument.querySelector(`#genres .render-genres .genre-btn[data-genre-name=\"${selectedGenres[i]}\"]`)?.classList.add(\"active\");\n\t}\n}\n\nconst getItemCardFields = (api2Flag) => {\n\treturn (api2Flag === true) \n\t? [ \n\t\t\t\"id\", \n\t\t\t\"code\", \n\t\t\t\"names\", \n\t\t\t\"genres\", \n\t\t\t\"posters\", \n\t\t\t\"status\", \n\t\t\t\"player\", \n\t\t\t\"season\", \n\t\t\t\"type\" \n\t\t]\n\t: [ \n\t\t\t\"id\", \n\t\t\t\"code\", \n\t\t\t\"names\", \n\t\t\t\"genres\", \n\t\t\t\"posters.medium.url\", \n\t\t\t\"status\", \n\t\t\t\"player.episodes\", \n\t\t\t\"season\", \n\t\t\t\"type\" \n\t\t]\n}\n\nconst setPageTitle = pageTitle => {\n\tdocument.querySelector(\"head title\").innerHTML = pageTitle;\n}\n\nconst nodeFromHTML = html => {\n\tconst container = document.createElement(\"DIV\");\n\tcontainer.innerHTML = html;\n\treturn item = container.childNodes[0];\n}\n\nconst addToFavourites = (postId, callback) => {\n\tconst sessId = getSessionId();\n\tif(sessId) {\n\t\tanilibriaRequest(\n\t\t\t\"user/favorites\",\n\t\t\t{\n\t\t\t\tsession: sessId,\n\t\t\t\ttitle_id: postId\n\t\t\t},\n\t\t\tresp => { \n\t\t\t\tapp().cacheProvider.unsetCache(\"favouritesList\");\n\t\t\t\tcallback(resp);\n\t\t\t},\n\t\t\t\"PUT\"\n\t\t);\n\t}\n}\n\nconst removeFromFavourites = (postId, callback) => {\n\tconst sessId = getSessionId();\n\tif(sessId) {\n\t\tanilibriaRequest(\n\t\t\t\"user/favorites\",\n\t\t\t{\n\t\t\t\tsession: sessId,\n\t\t\t\ttitle_id: postId\n\t\t\t},\n\t\t\tresp => {\n\t\t\t\tapp().cacheProvider.unsetCache(\"favouritesList\");\n\t\t\t\tcallback(resp);\n\t\t\t},\n\t\t\t\"DELETE\"\n\t\t);\n\t}\n}\n\nconst insertListToRenderContainer = (renderContainer, list) => {\n\tfor(let i = 0; i < list.length; i++) {\n\t\trenderContainer.appendChild(app().renderer.renderItemCard(list[i]).node);\n\t}\n}\n\nconst anilibriaRequest = (name, params, callback, method) => {\n\tparams = params || {};\n\n\tmethod = method || \"GET\";\n\tlet ver = _CONF.api.ver;\n\tif(name.indexOf(\":\") != -1) {\n\t\t[ver, name] = name.split(\":\");\n\t}\n\n\tlet url = `//${_CONF.api.domen}/api/${ver}/${name}`;\n\t\n\tif(params[\"filter\"]) {\t\n\t\tparams.filter = params.filter.join(\",\");\n\t}\n\n\tif(params[\"after\"] === 0) {\n\t\tdelete params[\"after\"];\n\t}\n\n\tconst query = (new URLSearchParams(params)).toString();\n\tif(query) {\n\t\turl += `?${query}`;\n\t}\n\n\tstdXHR(method, url,\n\t\txhr => {\n\t\t\tconst resp = JSON.parse(xhr.response);\n\t\t\tcallback(resp);\n\t\t}\n\t).send();\n}\n\nconst getSelectedGenres = () => {\n\tlet genres = document.location.hash.split(\"sg:\")[1];\n\tgenres = decodeURI(genres);\n\treturn genres.length ? genres.split(\",\") : [];\n}\n\nconst getStorablePlayerData = () => {\n\tconst data = {};\n\tconst keys = Object.keys(localStorage);\n\n\tfor(let key of keys) {\n\t\tif(key.indexOf(\"pljsplayfrom_main-player-\") == -1) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst id = parseInt(key.split(\"pljsplayfrom_main-player-\")[1]);\n\t\tlet val = localStorage.getItem(key);\n\t\t[watched, len, watchedAt] = val.split(\"}\")[1].split(\"--\");\n\t\tdata[id] = {\n\t\t\tcurrentEpisode: val.split(\"}\")[0].split(\"s\")[1],\n\t\t\ttiming: {\n\t\t\t\twatched: parseInt(watched),\n\t\t\t\tlen: parseInt(len),\n\t\t\t\twatchedAt: watchedAt\n\t\t\t}\n\t\t};\n\t}\n\n\treturn data;\n}","const initers = app => {\n\tapp.router.initPage(\"_page\", (router, pageId) => {\n\t\tdocument.querySelectorAll(\"#single .render-container\").forEach(i => { i.innerHTML = \"\"; });\n\t\tdocument.querySelector(`#${pageId} .preload-spinner`)?.classList.remove(\"dnone\");\n\t\tdocument.querySelector(`[name=\"search\"]`).value = \"\";\n\t\tdocument.querySelectorAll(\".page .more-btn\").forEach(i => i.classList.add(\"dnone\"));\n\t\thideMobNav();\n\n\t\tconst pageTitle = document.querySelector(`#${pageId}`)?.getAttribute(\"data-title\");\n\t\tsetPageTitle(pageTitle);\n\t});\n\n\tapp.router.initPage(\"login\", router => {\n\t\tif(getSessionId()) {\n\t\t\tdocument.location.hash = \"page:\" + router.notFoundPageId;\n\t\t}\n\t});\n\n\tapp.router.initPage(\"home\", router => {\n\t\tapp.loader.homePageUpToLoad(0, (resp) => {\n\t\t\tconst renderContainer = document.querySelector(\"#home .render-container\");\n\t\t\trenderContainer.innerHTML = \"\";\n\t\t\tdocument.querySelector(\"#home .preload-spinner\").classList.add(\"dnone\");\n\t\t\tresp.list.length && document.querySelector(\"#home .more-btn\").classList.remove(\"dnone\");\n\t\t\tinsertListToRenderContainer(renderContainer, resp.list);\n\t\t});\n\t});\n\n\tapp.router.initPage(\"single\", router => {\t\t\t\n\t\tconst id = document.location.hash.split(\"id\")[1];\n\n\t\tanilibriaRequest(\n\t\t\t\"title\", \n\t\t\t{\n\t\t\t\tid: id,\n\t\t\t\tinclude: \"raw_poster\"\n\t\t\t}, \n\t\t\tresp => {\n\t\t\t\tsetPageTitle(resp.names.ru);\n\t\t\t\tconst genres = resp.genres.join(\",\");\n\t\t\t\tconst renderContainer = document.querySelector(\"#single .render-container.main-render\");\n\t\t\t\trenderContainer.innerHTML = \"\";\n\t\t\t\tdocument.querySelector(\"#single .preload-spinner\").classList.add(\"dnone\");\n\t\t\t\trenderContainer.appendChild(app.renderer.renderSingle(resp).node);\n\n\t\t\t\tlet squery = resp.names.ru;\n\t\t\t\tconst filters = getItemCardFields().join(\",\");\n\n\t\t\t\tapp.cacheProvider.cacheable(\n\t\t\t\t\t`relatedTitles_id${resp.id}`,\n\t\t\t\t\tcacheableCallback => {\n\t\t\t\t\t\tanilibriaRequest(\n\t\t\t\t\t\t\t\"title/search\", \n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tsearch: resp.names.ru,\n\t\t\t\t\t\t\t\tafter: 0,\n\t\t\t\t\t\t\t\tlimit: _CONF.numbOfRelevant,\n\t\t\t\t\t\t\t\tfilter: getItemCardFields(),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcacheableCallback\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t\tresp => {\n\t\t\t\t\t\tresp.list.splice(_CONF.numbOfRelevant, resp.list.length);\n\t\t\t\t\t\tconst ids = resp.list.map(i => i.id);\n\t\t\t\t\t\tconst renderContainer = document.querySelector(\"#single .render-container.relevant-items-render\");\n\t\t\t\t\t\trenderContainer.innerHTML = \"\";\n\t\t\t\t\t\tinsertListToRenderContainer(renderContainer, resp.list.filter(i => i.id != id));\n\n\t\t\t\t\t\tif(_CONF.numbOfRelevant - renderContainer.childNodes.length > 0) {\n\t\t\t\t\t\t\tapp.cacheProvider.cacheable(\n\t\t\t\t\t\t\t\t`additionRelatedTitles_id${id}`,\n\t\t\t\t\t\t\t\tcacheableCallback => {\n\t\t\t\t\t\t\t\t\tanilibriaRequest(\n\t\t\t\t\t\t\t\t\t\t\"title/search\", \n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tsearch: \"\",\n\t\t\t\t\t\t\t\t\t\t\tgenres: genres,\n\t\t\t\t\t\t\t\t\t\t\tafter: 0,\n\t\t\t\t\t\t\t\t\t\t\tlimit: _CONF.numbOfRelevant + 1,\n\t\t\t\t\t\t\t\t\t\t\tfilter: getItemCardFields(),\n\t\t\t\t\t\t\t\t\t\t}, \n\t\t\t\t\t\t\t\t\t\tcacheableCallback\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tresp2 => {\n\t\t\t\t\t\t\t\t\tresp2.list = resp2.list.filter(i => i.id != id);\n\t\t\t\t\t\t\t\t\tfor(let i = 0; i < resp2.list.length; i++) {\n\t\t\t\t\t\t\t\t\t\tif(renderContainer.childNodes.length >= _CONF.numbOfRelevant) {\n\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif(ids.indexOf(resp2.list[i].id) > -1) {\n\t\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\trenderContainer.appendChild(app.renderer.renderItemCard(resp2.list[i]).node);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t60 * 60 * 3\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t60 * 60 * 3\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t});\n\n\tapp.router.initPage(\"favourites\", router => {\n\t\tapp.loader.favouritesList(resp => {\n\t\t\tconst renderContainer = document.querySelector(\"#favourites .render-container\");\n\t\t\tdocument.querySelector(\"#favourites .preload-spinner\").classList.add(\"dnone\");\n\t\t\trenderContainer.innerHTML = \"\";\n\t\t\tfor(let i = resp.length-1; i >= 0 ; i--) {\n\t\t\t\tresp[i].player.episodes = resp[i].player.series;\n\t\t\t\trenderContainer.appendChild(app.renderer.renderItemCard(resp[i]).node);\n\t\t\t}\n\t\t});\n\t});\n\n\tapp.router.initPage(\"search\", router => {\n\t\tlet squery = decodeURI(document.location.hash.split(\"sq:\")[1]);\n\t\tdocument.querySelector(`[name=\"search\"]`).value = squery;\n\n\t\tapp.loader.searchPageUpToLoad(0, resp => {\n\t\t\tconst renderContainer = document.querySelector(\"#search .render-container\");\n\t\t\trenderContainer.innerHTML = \"\";\n\t\t\tdocument.querySelector(\"#search .preload-spinner\").classList.add(\"dnone\");\n\t\t\tresp.list.length && document.querySelector(\"#search .more-btn\").classList.remove(\"dnone\");\n\t\t\tinsertListToRenderContainer(renderContainer, resp.list);\n\t\t});\n\t});\n\n\tapp.router.initPage(\"new-series\", router => {\n\t\tapp.cacheProvider.cacheable(\n\t\t\t\"new-series\",\n\t\t\tcacheableCallback => {\n\t\t\t\tanilibriaRequest(\n\t\t\t\t\t\"title/updates\", \n\t\t\t\t\t{\n\t\t\t\t\t\tafter: 0,\n\t\t\t\t\t\tlimit: 60,\n\t\t\t\t\t\tfilter: getItemCardFields(),\n\t\t\t\t\t},\n\t\t\t\t\tcacheableCallback\n\t\t\t\t);\n\t\t\t},\n\t\t\tresp => {\n\t\t\t\tconst renderContainer = document.querySelector(\"#new-series .render-container\");\n\t\t\t\trenderContainer.innerHTML = \"\";\n\t\t\t\tdocument.querySelector(\"#new-series .preload-spinner\").classList.add(\"dnone\");\n\n\t\t\t\tapp.loader.favouritesList(favs => {\n\t\t\t\t\tconst playerData = getStorablePlayerData();\n\n\t\t\t\t\tfor(let i = 0; i < resp.list.length; i++) {\n\t\t\t\t\t\tfor(let j = 0; j < favs.length; j++) {\n\t\t\t\t\t\t\tif(favs[j].id == resp.list[i].id) {\n\t\t\t\t\t\t\t\tif(playerData[resp.list[i].id]) {\n\t\t\t\t\t\t\t\t\tresp.list[i].localPlayerData = playerData[resp.list[i].id];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\trenderContainer.appendChild(app.renderer.renderItemCard(resp.list[i]).node);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t60 * 60 * 5\n\t\t);\n\t\t\n\t});\n\n\tapp.router.initPage(\"genres\", router => {\n\t\tlet selectedGenres = document.location.hash.split(\"sg:\")[1];\n\t\tsetTimeout(() => {\n\t\t\tmakeSelectedGenresActivated();\n\t\t}, 30);\n\n\t\tconst renderContainer = document.querySelector(\"#genres .render-container\");\n\t\tif(selectedGenres) {\n\t\t\tapp.loader.genresPageUpToLoad(0, resp => {\n\t\t\t\tconst renderContainer = document.querySelector(\"#genres .render-container\");\n\t\t\t\trenderContainer.innerHTML = \"\";\n\t\t\t\tdocument.querySelector(\"#genres .preload-spinner\").classList.add(\"dnone\");\n\t\t\t\tresp.list.length && document.querySelector(\"#genres .more-btn\").classList.remove(\"dnone\");\n\t\t\t\tinsertListToRenderContainer(renderContainer, resp.list);\n\t\t\t});\n\t\t} else {\n\t\t\trenderContainer.innerHTML = \"\";\n\t\t\tdocument.querySelector(\"#genres .preload-spinner\").classList.add(\"dnone\");\n\t\t}\n\t});\n}"]}